"use strict";(()=>{var e={};e.id=343,e.ids=[343],e.modules={67096:e=>{e.exports=require("bcrypt")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84629:e=>{e.exports=import("@libsql/client")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},33847:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>c,requestAsyncStorage:()=>x,routeModule:()=>p,serverHooks:()=>d,staticGenerationAsyncStorage:()=>l});var a=t(49303),i=t(88716),n=t(60670),o=t(12775),u=e([o]);o=(u.then?(await u)():u)[0];let p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/user/history/route",pathname:"/api/user/history",filename:"route",bundlePath:"app/api/user/history/route"},resolvedPagePath:"/Users/bytedance/Desktop/nababa-dress/src/app/api/user/history/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:x,staticGenerationAsyncStorage:l,serverHooks:d}=p,h="/api/user/history/route";function c(){return(0,n.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:l})}s()}catch(e){s(e)}})},12775:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{GET:()=>c,dynamic:()=>p});var a=t(87070),i=t(45609),n=t(95456),o=t(18289),u=e([n,o]);[n,o]=u.then?(await u)():u;let p="force-dynamic";async function c(e){try{let r;let t=await (0,i.getServerSession)(n.L);if(!t?.user?.id)return a.NextResponse.json({success:!1,message:"请先登录"},{status:401});let s=parseInt(t.user.id),{searchParams:u}=new URL(e.url),c=u.get("type"),p=parseInt(u.get("limit")||"30");switch(c){case"checkin":r=await o.K.getUserCheckinHistory(s,p);break;case"purchase":r=await o.K.getUserPurchaseHistory(s,p);break;case"generation":r=await o.K.getUserGenerationHistory(s,p);break;default:return a.NextResponse.json({success:!1,message:"无效的历史类型，支持: checkin, purchase, generation"},{status:400})}return a.NextResponse.json({success:!0,data:r})}catch(e){return console.error("获取用户历史失败:",e),a.NextResponse.json({success:!1,message:"获取历史数据失败，请稍后重试"},{status:500})}}s()}catch(e){s(e)}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,857,163],()=>t(33847));module.exports=s})();