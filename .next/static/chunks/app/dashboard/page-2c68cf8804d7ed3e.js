(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{216:function(e,r,t){Promise.resolve().then(t.bind(t,1789))},6463:function(e,r,t){"use strict";var s=t(1169);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})},1789:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return x}});var s=t(7437),a=t(998),n=t(2265),l=t(6463),i=t(7138),c=t(9733),d=t(8185),o=t(9055),u=t(1617);function x(){let{data:e,status:r,update:t}=(0,a.useSession)(),x=(0,l.useRouter)(),[f,m]=(0,n.useState)(null),[h,p]=(0,n.useState)(!0),[g,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if("unauthenticated"===r){x.push("/auth/signin");return}"authenticated"===r&&j()},[r,x]);let j=async()=>{try{let e=await fetch("/api/user/stats"),r=await e.json();r.success&&m(r.data)}catch(e){console.error("获取用户统计失败:",e)}finally{p(!1)}},b=async()=>{v(!0);try{let e=await fetch("/api/checkin",{method:"POST"}),r=await e.json();r.success&&(await t(),await j()),alert(r.message)}catch(e){console.error("签到失败:",e),alert("签到失败，请稍后重试")}finally{v(!1)}};if("loading"===r||h)return(0,s.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-48"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,s.jsx)("div",{className:"h-32 bg-gray-200 rounded"},e))})]})});if(!(null==e?void 0:e.user))return null;let N=e.user.userLevel||"free",y=e.user.credits||0,w=(e=>{switch(e){case"pro":return{title:"Pro用户",checkinFreq:"每日签到",checkinReward:"6积分",clothingLimit:"10件服装",batchGeneration:"批量生成",color:"text-purple-600",bgColor:"bg-purple-50"};case"plus":return{title:"Plus用户",checkinFreq:"每日签到",checkinReward:"6积分",clothingLimit:"3件服装",batchGeneration:"单次生成",color:"text-blue-600",bgColor:"bg-blue-50"};default:return{title:"免费用户",checkinFreq:"每周签到",checkinReward:"6积分",clothingLimit:"1件服装",batchGeneration:"单次生成",color:"text-gray-600",bgColor:"bg-gray-50"}}})(N);return(0,s.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:["欢迎回来，",e.user.email]}),(0,s.jsx)("p",{className:"text-gray-600",children:"管理您的账户、积分和AI试穿历史"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,s.jsxs)(d.Zb,{children:[(0,s.jsx)(d.Ol,{className:"pb-2",children:(0,s.jsx)(d.ll,{className:"text-sm font-medium text-gray-600",children:"当前积分"})}),(0,s.jsxs)(d.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:y}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"每次生成消耗 2-20 积分"})]})]}),(0,s.jsxs)(d.Zb,{children:[(0,s.jsx)(d.Ol,{className:"pb-2",children:(0,s.jsx)(d.ll,{className:"text-sm font-medium text-gray-600",children:"会员等级"})}),(0,s.jsxs)(d.aY,{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.C,{variant:"pro"===N?"default":"plus"===N?"info":"secondary",children:w.title}),"free"===N&&(0,s.jsx)(i.default,{href:"/upgrade",children:(0,s.jsx)(c.z,{variant:"outline",size:"sm",children:"升级"})})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[w.checkinFreq," \xb7 ",w.clothingLimit]})]})]}),(0,s.jsxs)(d.Zb,{children:[(0,s.jsx)(d.Ol,{className:"pb-2",children:(0,s.jsx)(d.ll,{className:"text-sm font-medium text-gray-600",children:"生成次数"})}),(0,s.jsxs)(d.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(null==f?void 0:f.totalGenerated)||0}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"历史生成总数"})]})]}),(0,s.jsxs)(d.Zb,{children:[(0,s.jsx)(d.Ol,{className:"pb-2",children:(0,s.jsx)(d.ll,{className:"text-sm font-medium text-gray-600",children:"签到状态"})}),(0,s.jsxs)(d.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(null==f?void 0:f.checkinStreak)||0}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"连续签到天数"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)(d.Zb,{children:[(0,s.jsxs)(d.Ol,{children:[(0,s.jsx)(d.ll,{children:"每日签到"}),(0,s.jsxs)(d.SZ,{children:[w.checkinFreq,"，每次获得 ",w.checkinReward]})]}),(0,s.jsxs)(d.aY,{className:"space-y-4",children:[(null==f?void 0:f.canCheckinToday)?(0,s.jsx)(c.z,{onClick:b,disabled:g,className:"w-full",children:g?"签到中...":"签到获得 ".concat(w.checkinReward)}):(0,s.jsxs)("div",{className:"text-center py-4",children:[(0,s.jsx)("div",{className:"text-green-600 text-2xl mb-2",children:"✓"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"free"===N?"本周已签到":"今日已签到"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:(null==f?void 0:f.lastCheckin)&&"上次签到: ".concat(new Date(f.lastCheckin).toLocaleString("zh-CN"))})]}),(null==f?void 0:f.checkinStreak)&&f.checkinStreak>0&&(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:["连续签到 ",f.checkinStreak," 天"]}),(0,s.jsx)(u.E,{value:Math.min(10*f.checkinStreak,100),className:"w-full h-2"})]})]})]}),(0,s.jsxs)(d.Zb,{className:w.bgColor,children:[(0,s.jsxs)(d.Ol,{children:[(0,s.jsxs)(d.ll,{className:w.color,children:[w.title,"特权"]}),(0,s.jsx)(d.SZ,{children:"您当前可享受的特权和福利"})]}),(0,s.jsxs)(d.aY,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"签到频率:"}),(0,s.jsx)("span",{className:"font-medium",children:w.checkinFreq})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"签到奖励:"}),(0,s.jsx)("span",{className:"font-medium",children:w.checkinReward})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"服装数量:"}),(0,s.jsx)("span",{className:"font-medium",children:w.clothingLimit})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"生成模式:"}),(0,s.jsx)("span",{className:"font-medium",children:w.batchGeneration})]})]}),"free"===N&&(0,s.jsx)("div",{className:"pt-3 border-t",children:(0,s.jsx)(i.default,{href:"/upgrade",children:(0,s.jsx)(c.z,{variant:"outline",className:"w-full",children:"升级到Plus"})})}),("free"===N||"plus"===N)&&(0,s.jsx)("div",{className:"free"===N?"":"pt-3 border-t",children:(0,s.jsx)(i.default,{href:"/purchase",children:(0,s.jsx)(c.z,{className:"w-full",children:"充值积分"})})})]})]})]}),(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"快速操作"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsx)(i.default,{href:"/generate",children:(0,s.jsxs)(c.z,{variant:"outline",className:"w-full h-20 flex flex-col",children:[(0,s.jsx)("div",{className:"text-2xl mb-1",children:"\uD83D\uDC57"}),(0,s.jsx)("span",{className:"text-sm",children:"AI试穿"})]})}),(0,s.jsx)(i.default,{href:"/purchase",children:(0,s.jsxs)(c.z,{variant:"outline",className:"w-full h-20 flex flex-col",children:[(0,s.jsx)("div",{className:"text-2xl mb-1",children:"\uD83D\uDC8E"}),(0,s.jsx)("span",{className:"text-sm",children:"充值积分"})]})}),(0,s.jsx)(i.default,{href:"/profile",children:(0,s.jsxs)(c.z,{variant:"outline",className:"w-full h-20 flex flex-col",children:[(0,s.jsx)("div",{className:"text-2xl mb-1",children:"\uD83D\uDCCA"}),(0,s.jsx)("span",{className:"text-sm",children:"生成历史"})]})}),"free"===N&&(0,s.jsx)(i.default,{href:"/upgrade",children:(0,s.jsxs)(c.z,{variant:"outline",className:"w-full h-20 flex flex-col",children:[(0,s.jsx)("div",{className:"text-2xl mb-1",children:"⭐"}),(0,s.jsx)("span",{className:"text-sm",children:"升级Plus"})]})})]})]})]})}},9055:function(e,r,t){"use strict";t.d(r,{C:function(){return i}});var s=t(7437);t(2265);var a=t(3027),n=t(9354);let l=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800 hover:bg-green-200",warning:"border-transparent bg-yellow-100 text-yellow-800 hover:bg-yellow-200",info:"border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(l({variant:t}),r),...a})}},9733:function(e,r,t){"use strict";t.d(r,{z:function(){return d}});var s=t(7437),a=t(2265),n=t(2974),l=t(3027),i=t(9354);let c=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,r)=>{let{className:t,variant:a,size:l,asChild:d=!1,...o}=e,u=d?n.g7:"button";return(0,s.jsx)(u,{className:(0,i.cn)(c({variant:a,size:l,className:t})),ref:r,...o})});d.displayName="Button"},8185:function(e,r,t){"use strict";t.d(r,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},ll:function(){return c}});var s=t(7437),a=t(2265),n=t(9354);let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});l.displayName="Card";let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});c.displayName="CardTitle";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...a})});o.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},1617:function(e,r,t){"use strict";t.d(r,{E:function(){return i}});var s=t(7437),a=t(2265),n=t(974),l=t(9354);let i=a.forwardRef((e,r)=>{let{className:t,value:a,...i}=e;return(0,s.jsx)(n.fC,{ref:r,className:(0,l.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...i,children:(0,s.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});i.displayName=n.fC.displayName},9354:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var s=t(4839),a=t(6164);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,s.W)(r))}},974:function(e,r,t){"use strict";t.d(r,{z$:function(){return N},fC:function(){return b}});var s=t(2265),a=t(7437);t(4887);var n=t(2974),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let t=(0,n.Z8)(`Primitive.${r}`),l=s.forwardRef((e,s)=>{let{asChild:n,...l}=e,i=n?t:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(i,{...l,ref:s})});return l.displayName=`Primitive.${r}`,{...e,[r]:l}},{}),i="Progress",[c,d]=function(e,r=[]){let t=[],n=()=>{let r=t.map(e=>s.createContext(e));return function(t){let a=t?.[e]||r;return s.useMemo(()=>({[`__scope${e}`]:{...t,[e]:a}}),[t,a])}};return n.scopeName=e,[function(r,n){let l=s.createContext(n),i=t.length;t=[...t,n];let c=r=>{let{scope:t,children:n,...c}=r,d=t?.[e]?.[i]||l,o=s.useMemo(()=>c,Object.values(c));return(0,a.jsx)(d.Provider,{value:o,children:n})};return c.displayName=r+"Provider",[c,function(t,a){let c=a?.[e]?.[i]||l,d=s.useContext(c);if(d)return d;if(void 0!==n)return n;throw Error(`\`${t}\` must be used within \`${r}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let t=()=>{let t=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let a=t.reduce((r,{useScope:t,scopeName:s})=>{let a=t(e)[`__scope${s}`];return{...r,...a}},{});return s.useMemo(()=>({[`__scope${r.scopeName}`]:a}),[a])}};return t.scopeName=r.scopeName,t}(n,...r)]}(i),[o,u]=c(i),x=s.forwardRef((e,r)=>{var t,s,n,i;let{__scopeProgress:c,value:d=null,max:u,getValueLabel:x=h,...f}=e;(u||0===u)&&!v(u)&&console.error((t="".concat(u),s="Progress","Invalid prop `max` of value `".concat(t,"` supplied to `").concat(s,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let m=v(u)?u:100;null===d||j(d,m)||console.error((n="".concat(d),i="Progress","Invalid prop `value` of value `".concat(n,"` supplied to `").concat(i,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let b=j(d,m)?d:null,N=g(b)?x(b,m):void 0;return(0,a.jsx)(o,{scope:c,value:b,max:m,children:(0,a.jsx)(l.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":g(b)?b:void 0,"aria-valuetext":N,role:"progressbar","data-state":p(b,m),"data-value":null!=b?b:void 0,"data-max":m,...f,ref:r})})});x.displayName=i;var f="ProgressIndicator",m=s.forwardRef((e,r)=>{var t;let{__scopeProgress:s,...n}=e,i=u(f,s);return(0,a.jsx)(l.div,{"data-state":p(i.value,i.max),"data-value":null!==(t=i.value)&&void 0!==t?t:void 0,"data-max":i.max,...n,ref:r})});function h(e,r){return"".concat(Math.round(e/r*100),"%")}function p(e,r){return null==e?"indeterminate":e===r?"complete":"loading"}function g(e){return"number"==typeof e}function v(e){return g(e)&&!isNaN(e)&&e>0}function j(e,r){return g(e)&&!isNaN(e)&&e<=r&&e>=0}m.displayName=f;var b=x,N=m}},function(e){e.O(0,[557,998,138,971,23,744],function(){return e(e.s=216)}),_N_E=e.O()}]);